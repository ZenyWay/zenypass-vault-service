(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/**
 * cuid.js
 * Collision-resistant UID generator for browsers and node.
 * Sequential for fast db lookups and recency sorting.
 * Safe for element IDs and server-side lookups.
 *
 * Extracted from CLCTR
 *
 * Copyright (c) Eric Elliott 2012
 * MIT License
 */

/*global window, navigator, document, require, process, module */
(function (app) {
  'use strict';
  var namespace = 'cuid',
    c = 0,
    blockSize = 4,
    base = 36,
    discreteValues = Math.pow(base, blockSize),

    pad = function pad(num, size) {
      var s = "000000000" + num;
      return s.substr(s.length-size);
    },

    randomBlock = function randomBlock() {
      return pad((Math.random() *
            discreteValues << 0)
            .toString(base), blockSize);
    },

    safeCounter = function () {
      c = (c < discreteValues) ? c : 0;
      c++; // this is not subliminal
      return c - 1;
    },

    api = function cuid() {
      // Starting with a lowercase letter makes
      // it HTML element ID friendly.
      var letter = 'c', // hard-coded allows for sequential access

        // timestamp
        // warning: this exposes the exact date and time
        // that the uid was created.
        timestamp = (new Date().getTime()).toString(base),

        // Prevent same-machine collisions.
        counter,

        // A few chars to generate distinct ids for different
        // clients (so different computers are far less
        // likely to generate the same id)
        fingerprint = api.fingerprint(),

        // Grab some more chars from Math.random()
        random = randomBlock() + randomBlock();

        counter = pad(safeCounter().toString(base), blockSize);

      return  (letter + timestamp + counter + fingerprint + random);
    };

  api.slug = function slug() {
    var date = new Date().getTime().toString(36),
      counter,
      print = api.fingerprint().slice(0,1) +
        api.fingerprint().slice(-1),
      random = randomBlock().slice(-2);

      counter = safeCounter().toString(36).slice(-4);

    return date.slice(-2) +
      counter + print + random;
  };

  api.globalCount = function globalCount() {
    // We want to cache the results of this
    var cache = (function calc() {
        var i,
          count = 0;

        for (i in window) {
          count++;
        }

        return count;
      }());

    api.globalCount = function () { return cache; };
    return cache;
  };

  api.fingerprint = function browserPrint() {
    return pad((navigator.mimeTypes.length +
      navigator.userAgent.length).toString(36) +
      api.globalCount().toString(36), 4);
  };

  // don't change anything from here down.
  if (app.register) {
    app.register(namespace, api);
  } else if (typeof module !== 'undefined') {
    module.exports = api;
  } else {
    app[namespace] = api;
  }

}(this.applitude || this));

},{}],2:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
;
var src_1 = require("../../src");
var cbox_vault_1 = require("cbox-vault");
var opgp_service_1 = require("opgp-service");
var randombins_1 = require("randombins");
var PouchDB = require('pouchdb-browser');
var pbkdf2sha512_1 = require("pbkdf2sha512");
var rxjs_1 = require("rxjs");
var debug = require("debug");
debug.enable('zp-vault-example:*');
var opgp = opgp_service_1.default();
var pbkdf2 = pbkdf2sha512_1.default({ iterations: 8192 });
var passphrase = pbkdf2('secret passphrase');
var keyspec = passphrase.then(function (digest) { return ({
    passphrase: digest.value,
    size: 2048,
    unlocked: true
}); });
var key = opgp.generateKey('john.doe@example.com', keyspec);
var alphabet = '-abcdefghijklmnopqrstuvw_';
var getRandomBins = randombins_1.default({ size: 16 });
var bins = getRandomBins([alphabet, alphabet])
    .reduce(function (arr, bin) { return arr.concat(bin); }, []);
var idHash = pbkdf2sha512_1.default({ iterations: 8192 });
var db = new PouchDB('zenypass');
var cbox = cbox_vault_1.default(db, opgp, {
    cipher: key,
    auth: key
}, {
    hash: function (passphrase) { return idHash(passphrase).then(function (_a) {
        var value = _a.value;
        return value;
    }); },
    bins: bins,
    read: { include_docs: true }
});
function authorize(passphrase) {
    return keyspec.then(function (_a) {
        var passphrase = _a.passphrase;
        return pbkdf2(passphrase)
            .then(function (digest) { return digest.value === passphrase; });
    });
}
var vault = src_1.default(cbox, authorize);
rxjs_1.Observable.from([
    { url: 'https://zenyway.com' },
    { url: 'https://en.wikipedia.org/w/index.php?title=Special:UserLogin' }
])
    .map(function (obj) { return vault.newAccount(obj); })
    .do(debug('zp-vault-example:account:source:'))
    .let(vault.write)
    .forEach(debug('zp-vault-example:account:persisted:'))
    .then(debug('zp-vault-example:account:done:'))
    .catch(debug('zp-vault-example:account:error:'));

},{"../../src":4,"cbox-vault":undefined,"debug":undefined,"opgp-service":undefined,"pbkdf2sha512":undefined,"pouchdb-browser":undefined,"randombins":undefined,"rxjs":undefined}],3:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
;
var rxjs_1 = require("rxjs");
var cuid = require('cuid');
var _AccountStreamOperators = (function () {
    function _AccountStreamOperators(newAccount, promises) {
        this.newAccount = newAccount;
        this.promises = promises;
    }
    _AccountStreamOperators.prototype.toAccount = function (doc$) {
        var _this = this;
        return doc$
            .map(function (doc) { return Array.isArray(doc)
            ? doc.map(_this.newAccount)
            : _this.newAccount(doc); })
            .share().observeOn(rxjs_1.Scheduler.asap);
    };
    _AccountStreamOperators.prototype.fromAccount = function (account$) {
        var _this = this;
        var uid = cuid();
        return account$
            .concatMap(function (account) { return Array.isArray(account)
            ? _this.fromAccount(rxjs_1.Observable.from(account)).toArray()
            : new Promise(function (resolve) {
                _this.promises[uid] = resolve;
                account.emit(uid);
            }); });
    };
    return _AccountStreamOperators;
}());
_AccountStreamOperators.getOperators = function (getAccountFactory) {
    var promises = {};
    function onEmit(doc, uid) {
        var resolve = promises[uid];
        setTimeout(function () { return resolve(doc); });
    }
    var newAccount = getAccountFactory(onEmit, { include_docref: true });
    var operators = new _AccountStreamOperators(newAccount, promises);
    return {
        newAccount: getAccountFactory(onEmit),
        toAccount: function (doc$) {
            return operators.toAccount(doc$);
        },
        fromAccount: function (account$) {
            return operators.fromAccount(account$);
        }
    };
};
var getOperators = _AccountStreamOperators.getOperators;
exports.default = getOperators;

},{"cuid":1,"rxjs":undefined}],4:[function(require,module,exports){
"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
;
var account_stream_operators_1 = require("./account-stream-operators");
var zenypass_account_model_1 = require("zenypass-account-model");
var rxjs_1 = require("rxjs");
var tslib_1 = require("tslib");
var VAULT_SERVICE_SPEC_DEFAULTS = {
    getAccountFactory: zenypass_account_model_1.default
};
var _VaultService = (function () {
    function _VaultService(vault, newAccount, operators) {
        this.vault = vault;
        this.newAccount = newAccount;
        this.operators = operators;
    }
    _VaultService.prototype.write = function (accounts) {
        var doc$ = this.operators.fromAccount(rxjs_1.Observable.from(accounts));
        var account$ = this.operators.toAccount(this.vault.write(doc$));
        return account$;
    };
    _VaultService.prototype.read = function (refs, opts) {
        var doc$ = this.vault.read(refs);
        var account$ = this.operators.toAccount(doc$);
        return account$;
    };
    return _VaultService;
}());
_VaultService.getInstance = function (vault, authorize, opts) {
    var spec = tslib_1.__assign({}, VAULT_SERVICE_SPEC_DEFAULTS, opts);
    var getCustomAccountFactory = spec.getAccountFactory.bind(void 0, authorize);
    var operators = account_stream_operators_1.default(getCustomAccountFactory);
    var accountVault = new _VaultService(vault, operators.newAccount, operators);
    return {
        newAccount: accountVault.newAccount.bind(accountVault),
        write: accountVault.write.bind(accountVault),
        read: accountVault.read.bind(accountVault),
        unlock: function (keys) {
            return _VaultService.getInstance(vault.unlock(keys), authorize, opts);
        }
    };
};
var getVaultService = _VaultService.getInstance;
exports.default = getVaultService;

},{"./account-stream-operators":3,"rxjs":undefined,"tslib":undefined,"zenypass-account-model":undefined}]},{},[2])
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIm5vZGVfbW9kdWxlcy9icm93c2VyLXBhY2svX3ByZWx1ZGUuanMiLCJub2RlX21vZHVsZXMvY3VpZC9kaXN0L2Jyb3dzZXItY3VpZC5qcyIsInNwZWMvZXhhbXBsZS9pbmRleC50cyIsInNyYy9hY2NvdW50LXN0cmVhbS1vcGVyYXRvcnMudHMiLCJzcmMvaW5kZXgudHMiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7QUNBQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7Ozs7QUNqR0EsQ0FBQztBQUNELGlDQUF1QztBQUN2Qyx5Q0FBOEQ7QUFDOUQsNkNBQTBEO0FBQzFELHlDQUE2QztBQUM3QyxJQUFNLE9BQU8sR0FBRyxPQUFPLENBQUMsaUJBQWlCLENBQUMsQ0FBQTtBQUMxQyw2Q0FBMkM7QUFDM0MsNkJBQWlD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QztRQUNMLFVBQVUsRUFBRSxZQUFZLENBQUMsVUFBVSxDQUFDLElBQUksQ0FBQyxZQUFZLENBQUM7UUFDdEQsS0FBSyxFQUFFLFlBQVksQ0FBQyxLQUFLLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBQztRQUM1QyxJQUFJLEVBQUUsWUFBWSxDQUFDLElBQUksQ0FBQyxJQUFJLENBQUMsWUFBWSxDQUFDO1FBQzFDLE1BQU0sWUFBRSxJQUFhO1lBQ25CLE1BQU0sQ0FBQyxhQUFhLENBQUMsV0FBVyxDQUFDLEtBQUssQ0FBQyxNQUFNLENBQUMsSUFBSSxDQUFDLEVBQUUsU0FBUyxFQUFFLElBQUksQ0FBQyxDQUFBO1FBQ3ZFLENBQUM7S0FDRixDQUFBO0FBQ0gsQ0FBQyxDQUFBO0FBeUJILElBQU0sZUFBZSxHQUFnQyxhQUFhLENBQUMsV0FBVyxDQUFBO0FBQzlFLGtCQUFlLGVBQWUsQ0FBQSIsImZpbGUiOiJnZW5lcmF0ZWQuanMiLCJzb3VyY2VSb290IjoiIiwic291cmNlc0NvbnRlbnQiOlsiKGZ1bmN0aW9uIGUodCxuLHIpe2Z1bmN0aW9uIHMobyx1KXtpZighbltvXSl7aWYoIXRbb10pe3ZhciBhPXR5cGVvZiByZXF1aXJlPT1cImZ1bmN0aW9uXCImJnJlcXVpcmU7aWYoIXUmJmEpcmV0dXJuIGEobywhMCk7aWYoaSlyZXR1cm4gaShvLCEwKTt2YXIgZj1uZXcgRXJyb3IoXCJDYW5ub3QgZmluZCBtb2R1bGUgJ1wiK28rXCInXCIpO3Rocm93IGYuY29kZT1cIk1PRFVMRV9OT1RfRk9VTkRcIixmfXZhciBsPW5bb109e2V4cG9ydHM6e319O3Rbb11bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtvXVsxXVtlXTtyZXR1cm4gcyhuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLHIpfXJldHVybiBuW29dLmV4cG9ydHN9dmFyIGk9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtmb3IodmFyIG89MDtvPHIubGVuZ3RoO28rKylzKHJbb10pO3JldHVybiBzfSkiLCIvKipcbiAqIGN1aWQuanNcbiAqIENvbGxpc2lvbi1yZXNpc3RhbnQgVUlEIGdlbmVyYXRvciBmb3IgYnJvd3NlcnMgYW5kIG5vZGUuXG4gKiBTZXF1ZW50aWFsIGZvciBmYXN0IGRiIGxvb2t1cHMgYW5kIHJlY2VuY3kgc29ydGluZy5cbiAqIFNhZmUgZm9yIGVsZW1lbnQgSURzIGFuZCBzZXJ2ZXItc2lkZSBsb29rdXBzLlxuICpcbiAqIEV4dHJhY3RlZCBmcm9tIENMQ1RSXG4gKlxuICogQ29weXJpZ2h0IChjKSBFcmljIEVsbGlvdHQgMjAxMlxuICogTUlUIExpY2Vuc2VcbiAqL1xuXG4vKmdsb2JhbCB3aW5kb3csIG5hdmlnYXRvciwgZG9jdW1lbnQsIHJlcXVpcmUsIHByb2Nlc3MsIG1vZHVsZSAqL1xuKGZ1bmN0aW9uIChhcHApIHtcbiAgJ3VzZSBzdHJpY3QnO1xuICB2YXIgbmFtZXNwYWNlID0gJ2N1aWQnLFxuICAgIGMgPSAwLFxuICAgIGJsb2NrU2l6ZSA9IDQsXG4gICAgYmFzZSA9IDM2LFxuICAgIGRpc2NyZXRlVmFsdWVzID0gTWF0aC5wb3coYmFzZSwgYmxvY2tTaXplKSxcblxuICAgIHBhZCA9IGZ1bmN0aW9uIHBhZChudW0sIHNpemUpIHtcbiAgICAgIHZhciBzID0gXCIwMDAwMDAwMDBcIiArIG51bTtcbiAgICAgIHJldHVybiBzLnN1YnN0cihzLmxlbmd0aC1zaXplKTtcbiAgICB9LFxuXG4gICAgcmFuZG9tQmxvY2sgPSBmdW5jdGlvbiByYW5kb21CbG9jaygpIHtcbiAgICAgIHJldHVybiBwYWQoKE1hdGgucmFuZG9tKCkgKlxuICAgICAgICAgICAgZGlzY3JldGVWYWx1ZXMgPDwgMClcbiAgICAgICAgICAgIC50b1N0cmluZyhiYXNlKSwgYmxvY2tTaXplKTtcbiAgICB9LFxuXG4gICAgc2FmZUNvdW50ZXIgPSBmdW5jdGlvbiAoKSB7XG4gICAgICBjID0gKGMgPCBkaXNjcmV0ZVZhbHVlcykgPyBjIDogMDtcbiAgICAgIGMrKzsgLy8gdGhpcyBpcyBub3Qgc3VibGltaW5hbFxuICAgICAgcmV0dXJuIGMgLSAxO1xuICAgIH0sXG5cbiAgICBhcGkgPSBmdW5jdGlvbiBjdWlkKCkge1xuICAgICAgLy8gU3RhcnRpbmcgd2l0aCBhIGxvd2VyY2FzZSBsZXR0ZXIgbWFrZXNcbiAgICAgIC8vIGl0IEhUTUwgZWxlbWVudCBJRCBmcmllbmRseS5cbiAgICAgIHZhciBsZXR0ZXIgPSAnYycsIC8vIGhhcmQtY29kZWQgYWxsb3dzIGZvciBzZXF1ZW50aWFsIGFjY2Vzc1xuXG4gICAgICAgIC8vIHRpbWVzdGFtcFxuICAgICAgICAvLyB3YXJuaW5nOiB0aGlzIGV4cG9zZXMgdGhlIGV4YWN0IGRhdGUgYW5kIHRpbWVcbiAgICAgICAgLy8gdGhhdCB0aGUgdWlkIHdhcyBjcmVhdGVkLlxuICAgICAgICB0aW1lc3RhbXAgPSAobmV3IERhdGUoKS5nZXRUaW1lKCkpLnRvU3RyaW5nKGJhc2UpLFxuXG4gICAgICAgIC8vIFByZXZlbnQgc2FtZS1tYWNoaW5lIGNvbGxpc2lvbnMuXG4gICAgICAgIGNvdW50ZXIsXG5cbiAgICAgICAgLy8gQSBmZXcgY2hhcnMgdG8gZ2VuZXJhdGUgZGlzdGluY3QgaWRzIGZvciBkaWZmZXJlbnRcbiAgICAgICAgLy8gY2xpZW50cyAoc28gZGlmZmVyZW50IGNvbXB1dGVycyBhcmUgZmFyIGxlc3NcbiAgICAgICAgLy8gbGlrZWx5IHRvIGdlbmVyYXRlIHRoZSBzYW1lIGlkKVxuICAgICAgICBmaW5nZXJwcmludCA9IGFwaS5maW5nZXJwcmludCgpLFxuXG4gICAgICAgIC8vIEdyYWIgc29tZSBtb3JlIGNoYXJzIGZyb20gTWF0aC5yYW5kb20oKVxuICAgICAgICByYW5kb20gPSByYW5kb21CbG9jaygpICsgcmFuZG9tQmxvY2soKTtcblxuICAgICAgICBjb3VudGVyID0gcGFkKHNhZmVDb3VudGVyKCkudG9TdHJpbmcoYmFzZSksIGJsb2NrU2l6ZSk7XG5cbiAgICAgIHJldHVybiAgKGxldHRlciArIHRpbWVzdGFtcCArIGNvdW50ZXIgKyBmaW5nZXJwcmludCArIHJhbmRvbSk7XG4gICAgfTtcblxuICBhcGkuc2x1ZyA9IGZ1bmN0aW9uIHNsdWcoKSB7XG4gICAgdmFyIGRhdGUgPSBuZXcgRGF0ZSgpLmdldFRpbWUoKS50b1N0cmluZygzNiksXG4gICAgICBjb3VudGVyLFxuICAgICAgcHJpbnQgPSBhcGkuZmluZ2VycHJpbnQoKS5zbGljZSgwLDEpICtcbiAgICAgICAgYXBpLmZpbmdlcnByaW50KCkuc2xpY2UoLTEpLFxuICAgICAgcmFuZG9tID0gcmFuZG9tQmxvY2soKS5zbGljZSgtMik7XG5cbiAgICAgIGNvdW50ZXIgPSBzYWZlQ291bnRlcigpLnRvU3RyaW5nKDM2KS5zbGljZSgtNCk7XG5cbiAgICByZXR1cm4gZGF0ZS5zbGljZSgtMikgK1xuICAgICAgY291bnRlciArIHByaW50ICsgcmFuZG9tO1xuICB9O1xuXG4gIGFwaS5nbG9iYWxDb3VudCA9IGZ1bmN0aW9uIGdsb2JhbENvdW50KCkge1xuICAgIC8vIFdlIHdhbnQgdG8gY2FjaGUgdGhlIHJlc3VsdHMgb2YgdGhpc1xuICAgIHZhciBjYWNoZSA9IChmdW5jdGlvbiBjYWxjKCkge1xuICAgICAgICB2YXIgaSxcbiAgICAgICAgICBjb3VudCA9IDA7XG5cbiAgICAgICAgZm9yIChpIGluIHdpbmRvdykge1xuICAgICAgICAgIGNvdW50Kys7XG4gICAgICAgIH1cblxuICAgICAgICByZXR1cm4gY291bnQ7XG4gICAgICB9KCkpO1xuXG4gICAgYXBpLmdsb2JhbENvdW50ID0gZnVuY3Rpb24gKCkgeyByZXR1cm4gY2FjaGU7IH07XG4gICAgcmV0dXJuIGNhY2hlO1xuICB9O1xuXG4gIGFwaS5maW5nZXJwcmludCA9IGZ1bmN0aW9uIGJyb3dzZXJQcmludCgpIHtcbiAgICByZXR1cm4gcGFkKChuYXZpZ2F0b3IubWltZVR5cGVzLmxlbmd0aCArXG4gICAgICBuYXZpZ2F0b3IudXNlckFnZW50Lmxlbmd0aCkudG9TdHJpbmcoMzYpICtcbiAgICAgIGFwaS5nbG9iYWxDb3VudCgpLnRvU3RyaW5nKDM2KSwgNCk7XG4gIH07XG5cbiAgLy8gZG9uJ3QgY2hhbmdlIGFueXRoaW5nIGZyb20gaGVyZSBkb3duLlxuICBpZiAoYXBwLnJlZ2lzdGVyKSB7XG4gICAgYXBwLnJlZ2lzdGVyKG5hbWVzcGFjZSwgYXBpKTtcbiAgfSBlbHNlIGlmICh0eXBlb2YgbW9kdWxlICE9PSAndW5kZWZpbmVkJykge1xuICAgIG1vZHVsZS5leHBvcnRzID0gYXBpO1xuICB9IGVsc2Uge1xuICAgIGFwcFtuYW1lc3BhY2VdID0gYXBpO1xuICB9XG5cbn0odGhpcy5hcHBsaXR1ZGUgfHwgdGhpcykpO1xuIiwiLypcbiAqIENvcHlyaWdodCAyMDE3IFN0ZXBoYW5lIE0uIENhdGFsYVxuICpcbiAqIExpY2Vuc2VkIHVuZGVyIHRoZSBBcGFjaGUgTGljZW5zZSwgVmVyc2lvbiAyLjAgKHRoZSBcIkxpY2Vuc2VcIik7XG4gKiB5b3UgbWF5IG5vdCB1c2UgdGhpcyBmaWxlIGV4Y2VwdCBpbiBjb21wbGlhbmNlIHdpdGggdGhlIExpY2Vuc2UuXG4gKiBZb3UgbWF5IG9idGFpbiBhIGNvcHkgb2YgdGhlIExpY2Vuc2UgYXRcbiAqICBodHRwOi8vd3d3LmFwYWNoZS5vcmcvbGljZW5zZXMvTElDRU5TRS0yLjBcbiAqIFVubGVzcyByZXF1aXJlZCBieSBhcHBsaWNhYmxlIGxhdyBvciBhZ3JlZWQgdG8gaW4gd3JpdGluZyxcbiAqIHNvZnR3YXJlIGRpc3RyaWJ1dGVkIHVuZGVyIHRoZSBMaWNlbnNlIGlzIGRpc3RyaWJ1dGVkIG9uIGFuIFwiQVMgSVNcIiBCQVNJUyxcbiAqIFdJVEhPVVQgV0FSUkFOVElFUyBPUiBDT05ESVRJT05TIE9GIEFOWSBLSU5ELCBlaXRoZXIgZXhwcmVzcyBvciBpbXBsaWVkLlxuICogU2VlIHRoZSBMaWNlbnNlIGZvciB0aGUgc3BlY2lmaWMgbGFuZ3VhZ2UgZ292ZXJuaW5nIHBlcm1pc3Npb25zIGFuZFxuICogTGltaXRhdGlvbnMgdW5kZXIgdGhlIExpY2Vuc2UuXG4gKi9cbjtcbmltcG9ydCBnZXRWYXVsdFNlcnZpY2UgZnJvbSAnLi4vLi4vc3JjJ1xuaW1wb3J0IGdldENib3hWYXVsdCwgeyBEb2NJZCwgVmVyc2lvbmVkRG9jIH0gZnJvbSAnY2JveC12YXVsdCdcbmltcG9ydCBnZXRPcGdwU2VydmljZSwgeyBPcGdwS2V5T3B0cyB9IGZyb20gJ29wZ3Atc2VydmljZSdcbmltcG9ydCBnZXRSYW5kb21CaW5zRmFjdG9yeSBmcm9tICdyYW5kb21iaW5zJ1xuY29uc3QgUG91Y2hEQiA9IHJlcXVpcmUoJ3BvdWNoZGItYnJvd3NlcicpXG5pbXBvcnQgZ2V0UGJrZGYyT1NoYTUxMiBmcm9tICdwYmtkZjJzaGE1MTInXG5pbXBvcnQgeyBPYnNlcnZhYmxlIH0gZnJvbSAncnhqcydcbmltcG9ydCBkZWJ1ZyA9IHJlcXVpcmUoJ2RlYnVnJylcbmRlYnVnLmVuYWJsZSgnenAtdmF1bHQtZXhhbXBsZToqJylcblxuY29uc3Qgb3BncCA9IGdldE9wZ3BTZXJ2aWNlKClcbmNvbnN0IHBia2RmMiA9IGdldFBia2RmMk9TaGE1MTIoeyBpdGVyYXRpb25zOiA4MTkyIH0pIC8vIG1pbiBpdGVyYXRpb25zXG5cbi8vIHNldCB1cCBrZXkgcGFpclxuY29uc3QgcGFzc3BocmFzZSA9IHBia2RmMignc2VjcmV0IHBhc3NwaHJhc2UnKVxuY29uc3Qga2V5c3BlYzogUHJvbWlzZTxPcGdwS2V5T3B0cz4gPSBwYXNzcGhyYXNlLnRoZW4oZGlnZXN0ID0+ICh7XG4gIHBhc3NwaHJhc2U6IGRpZ2VzdC52YWx1ZSxcbiAgc2l6ZTogMjA0OCxcbiAgdW5sb2NrZWQ6IHRydWVcbn0pKVxuY29uc3Qga2V5ID0gb3BncC5nZW5lcmF0ZUtleSgnam9obi5kb2VAZXhhbXBsZS5jb20nLCBrZXlzcGVjKVxuXG4vLyBkZWZpbmUgcmFuZG9tIGJpbnMgZm9yIG1vcmUgZWZmaWNpZW50IHN0YXJ0a2V5L2VuZGtleSBzZWFyY2hcbi8vIFRPRE86IGludGVncmF0ZSB0aGlzIGludG8gWmVueXBhc3NWYXVsdFNlcnZpY2VcbmNvbnN0IGFscGhhYmV0ID0gJy1hYmNkZWZnaGlqa2xtbm9wcXJzdHV2d18nXG5jb25zdCBnZXRSYW5kb21CaW5zID0gZ2V0UmFuZG9tQmluc0ZhY3RvcnkoeyBzaXplOiAxNn0pXG5jb25zdCBiaW5zID0gZ2V0UmFuZG9tQmlucyhbIGFscGhhYmV0LCBhbHBoYWJldCBdKVxuLnJlZHVjZSgoYXJyLCBiaW4pID0+IGFyci5jb25jYXQoYmluKSwgW10pXG5cbmNvbnN0IGlkSGFzaCA9IGdldFBia2RmMk9TaGE1MTIoeyBpdGVyYXRpb25zOiA4MTkyIH0pXG5cbmNvbnN0IGRiID0gbmV3IFBvdWNoREIoJ3plbnlwYXNzJylcbmNvbnN0IGNib3ggPSBnZXRDYm94VmF1bHQoZGIsIG9wZ3AsIHsgLy8gZW5jcnlwdCBhbmQgc2lnbiB3aXRoIHNhbWUga2V5LXBhaXJcbiAgY2lwaGVyOiBrZXksXG4gIGF1dGg6IGtleVxufSwge1xuICBoYXNoOiAocGFzc3BocmFzZTogc3RyaW5nKSA9PiBpZEhhc2gocGFzc3BocmFzZSkudGhlbigoeyB2YWx1ZSB9KSA9PiB2YWx1ZSksXG4gIGJpbnM6IGJpbnMsXG4gIHJlYWQ6IHsgaW5jbHVkZV9kb2NzOiB0cnVlIH0gLy8gcmVxdWlyZWQgZm9yIGJ1bGsgcmVhZFxufSlcblxuZnVuY3Rpb24gYXV0aG9yaXplIChwYXNzcGhyYXNlOiBzdHJpbmcpOiBQcm9taXNlPGJvb2xlYW4+IHtcbiAgcmV0dXJuIGtleXNwZWMudGhlbigoeyBwYXNzcGhyYXNlIH0pID0+IHBia2RmMihwYXNzcGhyYXNlKVxuICAudGhlbihkaWdlc3QgPT4gZGlnZXN0LnZhbHVlID09PSBwYXNzcGhyYXNlKSkgLy8gb3B0aW9uYWxseSByZWplY3Qgd2l0aCBFcnJvciB3aGVuIHVuYXV0aG9yaXplZFxufVxuXG5jb25zdCB2YXVsdCA9IGdldFZhdWx0U2VydmljZShjYm94LCBhdXRob3JpemUpXG5cbk9ic2VydmFibGUuZnJvbShbXG4gIHsgdXJsOiAnaHR0cHM6Ly96ZW55d2F5LmNvbScgfSxcbiAgeyB1cmw6ICdodHRwczovL2VuLndpa2lwZWRpYS5vcmcvdy9pbmRleC5waHA/dGl0bGU9U3BlY2lhbDpVc2VyTG9naW4nIH1cbl0pXG4ubWFwKG9iaiA9PiB2YXVsdC5uZXdBY2NvdW50KG9iaikpXG4uZG8oZGVidWcoJ3pwLXZhdWx0LWV4YW1wbGU6YWNjb3VudDpzb3VyY2U6JykpXG4ubGV0KHZhdWx0LndyaXRlKVxuLmZvckVhY2goZGVidWcoJ3pwLXZhdWx0LWV4YW1wbGU6YWNjb3VudDpwZXJzaXN0ZWQ6JykpXG4udGhlbihkZWJ1ZygnenAtdmF1bHQtZXhhbXBsZTphY2NvdW50OmRvbmU6JykpXG4uY2F0Y2goZGVidWcoJ3pwLXZhdWx0LWV4YW1wbGU6YWNjb3VudDplcnJvcjonKSlcbiIsIi8qXG4gKiBDb3B5cmlnaHQgMjAxNyBTdGVwaGFuZSBNLiBDYXRhbGFcbiAqXG4gKiBMaWNlbnNlZCB1bmRlciB0aGUgQXBhY2hlIExpY2Vuc2UsIFZlcnNpb24gMi4wICh0aGUgXCJMaWNlbnNlXCIpO1xuICogeW91IG1heSBub3QgdXNlIHRoaXMgZmlsZSBleGNlcHQgaW4gY29tcGxpYW5jZSB3aXRoIHRoZSBMaWNlbnNlLlxuICogWW91IG1heSBvYnRhaW4gYSBjb3B5IG9mIHRoZSBMaWNlbnNlIGF0XG4gKiAgaHR0cDovL3d3dy5hcGFjaGUub3JnL2xpY2Vuc2VzL0xJQ0VOU0UtMi4wXG4gKiBVbmxlc3MgcmVxdWlyZWQgYnkgYXBwbGljYWJsZSBsYXcgb3IgYWdyZWVkIHRvIGluIHdyaXRpbmcsXG4gKiBzb2Z0d2FyZSBkaXN0cmlidXRlZCB1bmRlciB0aGUgTGljZW5zZSBpcyBkaXN0cmlidXRlZCBvbiBhbiBcIkFTIElTXCIgQkFTSVMsXG4gKiBXSVRIT1VUIFdBUlJBTlRJRVMgT1IgQ09ORElUSU9OUyBPRiBBTlkgS0lORCwgZWl0aGVyIGV4cHJlc3Mgb3IgaW1wbGllZC5cbiAqIFNlZSB0aGUgTGljZW5zZSBmb3IgdGhlIHNwZWNpZmljIGxhbmd1YWdlIGdvdmVybmluZyBwZXJtaXNzaW9ucyBhbmRcbiAqIExpbWl0YXRpb25zIHVuZGVyIHRoZSBMaWNlbnNlLlxuICovXG47XG5pbXBvcnQgeyBPYnNlcnZhYmxlLCBTdWJqZWN0LCBTY2hlZHVsZXIgfSBmcm9tICdyeGpzJ1xuaW1wb3J0IHsgQWNjb3VudEZhY3RvcnlTcGVjLCBBY2NvdW50RmFjdG9yeSwgQWNjb3VudCwgQWNjb3VudERvYyB9IGZyb20gJ3plbnlwYXNzLWFjY291bnQtbW9kZWwnXG5jb25zdCBjdWlkID0gcmVxdWlyZSgnY3VpZCcpXG5cbmV4cG9ydCBpbnRlcmZhY2UgQWNjb3VudFN0cmVhbU9wZXJhdG9yc0ZhY3Rvcnkge1xuICAoZ2V0QWNjb3VudEZhY3Rvcnk6IEN1c3RvbUFjY291bnRGYWN0b3J5QnVpbGRlcixcbiAgb3B0cz86IFBhcnRpYWw8QWNjb3VudFN0cmVhbU9wZXJhdG9yc0ZhY3RvcnlTcGVjPik6IEFjY291bnRTdHJlYW1PcGVyYXRvcnNcbn1cblxuZXhwb3J0IGludGVyZmFjZSBDdXN0b21BY2NvdW50RmFjdG9yeUJ1aWxkZXIge1xuICAob25FbWl0OiA8VD4oZG9jOiBQYXJ0aWFsPEFjY291bnREb2M+LCAuLi5hcmdzOiBhbnlbXSkgPT4gVCxcbiAgb3B0cz86IFBhcnRpYWw8QWNjb3VudEZhY3RvcnlTcGVjPik6IEFjY291bnRGYWN0b3J5XG59XG5cbmV4cG9ydCBpbnRlcmZhY2UgQWNjb3VudFN0cmVhbU9wZXJhdG9yc0ZhY3RvcnlTcGVjIHtcbiAgLy8gdm9pZFxufVxuXG5leHBvcnQgaW50ZXJmYWNlIEFjY291bnRTdHJlYW1PcGVyYXRvcnMge1xuICBuZXdBY2NvdW50OiBBY2NvdW50RmFjdG9yeVxuICB0b0FjY291bnQgKGRvYyQ6IE9ic2VydmFibGU8QWNjb3VudERvYz4pOiBPYnNlcnZhYmxlPEFjY291bnQ+XG4gIHRvQWNjb3VudCAoZG9jJDogT2JzZXJ2YWJsZTxBY2NvdW50RG9jW10+KTogT2JzZXJ2YWJsZTxBY2NvdW50W10+XG4gIHRvQWNjb3VudCAoZG9jJDogT2JzZXJ2YWJsZTxBY2NvdW50RG9jW118QWNjb3VudERvYz4pOiBPYnNlcnZhYmxlPEFjY291bnRbXXxBY2NvdW50PlxuICBmcm9tQWNjb3VudCAoYWNjb3VudCQ6IE9ic2VydmFibGU8QWNjb3VudD4pOiBPYnNlcnZhYmxlPEFjY291bnREb2M+XG4gIGZyb21BY2NvdW50IChhY2NvdW50JDogT2JzZXJ2YWJsZTxBY2NvdW50W10+KTogT2JzZXJ2YWJsZTxBY2NvdW50RG9jW10+XG4gIGZyb21BY2NvdW50IChhY2NvdW50JDogT2JzZXJ2YWJsZTxBY2NvdW50W118QWNjb3VudD4pOiBPYnNlcnZhYmxlPEFjY291bnREb2NbXXxBY2NvdW50RG9jPlxufVxuXG5pbnRlcmZhY2UgQWNjb3VudERvY0V2ZW50IHtcbiAgdWlkOiBzdHJpbmdcbiAgZG9jOiBBY2NvdW50RG9jXG59XG5cbmNsYXNzIF9BY2NvdW50U3RyZWFtT3BlcmF0b3JzIHtcbiAgc3RhdGljIGdldE9wZXJhdG9yczogQWNjb3VudFN0cmVhbU9wZXJhdG9yc0ZhY3RvcnkgPVxuICBmdW5jdGlvbiAoZ2V0QWNjb3VudEZhY3Rvcnk6IEN1c3RvbUFjY291bnRGYWN0b3J5QnVpbGRlcikge1xuICAgIGNvbnN0IHByb21pc2VzID0ge30gLy8gcmVzb2x2ZSBmdW5jdGlvbiBpcyBleGNoYW5nZWQgb3ZlciB0aGlzIHByaXZhdGUgb2JqZWN0XG4gICAgZnVuY3Rpb24gb25FbWl0IChkb2M6IEFjY291bnREb2MsIHVpZDogc3RyaW5nKSB7XG4gICAgICBjb25zdCByZXNvbHZlID0gcHJvbWlzZXNbdWlkXVxuICAgICAgc2V0VGltZW91dCgoKSA9PiByZXNvbHZlKGRvYykpXG4gICAgfVxuICAgIGNvbnN0IG5ld0FjY291bnQgPSBnZXRBY2NvdW50RmFjdG9yeShvbkVtaXQsIHsgaW5jbHVkZV9kb2NyZWY6IHRydWUgfSkgLy8gcHJpdmF0ZSBmYWN0b3J5XG4gICAgY29uc3Qgb3BlcmF0b3JzID0gbmV3IF9BY2NvdW50U3RyZWFtT3BlcmF0b3JzKG5ld0FjY291bnQsIHByb21pc2VzKVxuXG4gICAgcmV0dXJuIHtcbiAgICAgIG5ld0FjY291bnQ6IGdldEFjY291bnRGYWN0b3J5KG9uRW1pdCksIC8vIHB1YmxpYyBmYWN0b3J5XG4gICAgICB0b0FjY291bnQgKGRvYyQ6IE9ic2VydmFibGU8QWNjb3VudERvY1tdfEFjY291bnREb2M+KSB7XG4gICAgICAgIHJldHVybiBvcGVyYXRvcnMudG9BY2NvdW50KGRvYyQpXG4gICAgICB9LFxuICAgICAgZnJvbUFjY291bnQgKGFjY291bnQkOiBPYnNlcnZhYmxlPEFjY291bnRbXXxBY2NvdW50Pik6IE9ic2VydmFibGU8QWNjb3VudERvY1tdfEFjY291bnREb2M+IHtcbiAgICAgICAgcmV0dXJuIG9wZXJhdG9ycy5mcm9tQWNjb3VudChhY2NvdW50JClcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB0b0FjY291bnQgKGRvYyQ6IE9ic2VydmFibGU8QWNjb3VudERvY1tdfEFjY291bnREb2M+KSB7XG4gICAgcmV0dXJuIGRvYyRcbiAgICAubWFwKGRvYyA9PiBBcnJheS5pc0FycmF5KGRvYylcbiAgICA/IGRvYy5tYXAodGhpcy5uZXdBY2NvdW50KVxuICAgIDogdGhpcy5uZXdBY2NvdW50KGRvYykpXG4gICAgLnNoYXJlKCkub2JzZXJ2ZU9uKFNjaGVkdWxlci5hc2FwKSAvLyBpc29sYXRlIHN1YnNjcmliZXJzIGZyb20gdW5oYW5kbGVkIGVycm9yc1xuICB9XG5cbiAgZnJvbUFjY291bnQgKGFjY291bnQkOiBPYnNlcnZhYmxlPEFjY291bnQ+KTogT2JzZXJ2YWJsZTxBY2NvdW50RG9jPlxuICBmcm9tQWNjb3VudCAoYWNjb3VudCQ6IE9ic2VydmFibGU8QWNjb3VudFtdfEFjY291bnQ+KTogT2JzZXJ2YWJsZTxBY2NvdW50RG9jW118QWNjb3VudERvYz4ge1xuICAgIGNvbnN0IHVpZCA9IDxzdHJpbmc+Y3VpZCgpXG5cbiAgICByZXR1cm4gYWNjb3VudCRcbiAgICAuY29uY2F0TWFwPEFjY291bnQsQWNjb3VudERvY1tdfEFjY291bnREb2M+KGFjY291bnQgPT4gQXJyYXkuaXNBcnJheShhY2NvdW50KVxuICAgID8gdGhpcy5mcm9tQWNjb3VudChPYnNlcnZhYmxlLmZyb20oYWNjb3VudCkpLnRvQXJyYXkoKVxuICAgIDogbmV3IFByb21pc2U8QWNjb3VudERvYz4ocmVzb2x2ZSA9PiB7XG4gICAgICB0aGlzLnByb21pc2VzW3VpZF0gPSByZXNvbHZlXG4gICAgICBhY2NvdW50LmVtaXQodWlkKVxuICAgIH0pKVxuICB9XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvciAoXG4gICAgcHJpdmF0ZSByZWFkb25seSBuZXdBY2NvdW50OiBBY2NvdW50RmFjdG9yeSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IHByb21pc2VzOiB7IFsgdWlkOiBzdHJpbmcgXTogKHZhbHVlOiBBY2NvdW50RG9jKSA9PiB2b2lkIH1cbiAgKSB7fVxufVxuXG5jb25zdCBnZXRPcGVyYXRvcnM6IEFjY291bnRTdHJlYW1PcGVyYXRvcnNGYWN0b3J5ID1cbl9BY2NvdW50U3RyZWFtT3BlcmF0b3JzLmdldE9wZXJhdG9yc1xuXG5leHBvcnQgZGVmYXVsdCBnZXRPcGVyYXRvcnMiLCIvKlxuICogQ29weXJpZ2h0IDIwMTcgU3RlcGhhbmUgTS4gQ2F0YWxhXG4gKlxuICogTGljZW5zZWQgdW5kZXIgdGhlIEFwYWNoZSBMaWNlbnNlLCBWZXJzaW9uIDIuMCAodGhlIFwiTGljZW5zZVwiKTtcbiAqIHlvdSBtYXkgbm90IHVzZSB0aGlzIGZpbGUgZXhjZXB0IGluIGNvbXBsaWFuY2Ugd2l0aCB0aGUgTGljZW5zZS5cbiAqIFlvdSBtYXkgb2J0YWluIGEgY29weSBvZiB0aGUgTGljZW5zZSBhdFxuICogIGh0dHA6Ly93d3cuYXBhY2hlLm9yZy9saWNlbnNlcy9MSUNFTlNFLTIuMFxuICogVW5sZXNzIHJlcXVpcmVkIGJ5IGFwcGxpY2FibGUgbGF3IG9yIGFncmVlZCB0byBpbiB3cml0aW5nLFxuICogc29mdHdhcmUgZGlzdHJpYnV0ZWQgdW5kZXIgdGhlIExpY2Vuc2UgaXMgZGlzdHJpYnV0ZWQgb24gYW4gXCJBUyBJU1wiIEJBU0lTLFxuICogV0lUSE9VVCBXQVJSQU5USUVTIE9SIENPTkRJVElPTlMgT0YgQU5ZIEtJTkQsIGVpdGhlciBleHByZXNzIG9yIGltcGxpZWQuXG4gKiBTZWUgdGhlIExpY2Vuc2UgZm9yIHRoZSBzcGVjaWZpYyBsYW5ndWFnZSBnb3Zlcm5pbmcgcGVybWlzc2lvbnMgYW5kXG4gKiBMaW1pdGF0aW9ucyB1bmRlciB0aGUgTGljZW5zZS5cbiAqL1xuO1xuaW1wb3J0IGdldEFjY291bnRTdHJlYW1PcGVyYXRvcnMsIHsgQWNjb3VudFN0cmVhbU9wZXJhdG9ycyB9IGZyb20gJy4vYWNjb3VudC1zdHJlYW0tb3BlcmF0b3JzJ1xuaW1wb3J0IHsgaXNGdW5jdGlvbiB9IGZyb20gJy4vdXRpbHMnXG5pbXBvcnQgeyBPcGdwU2VydmljZSwgT3BncFByb3h5S2V5IH0gZnJvbSAnb3BncC1zZXJ2aWNlJ1xuaW1wb3J0IHtcbiAgQ2JveFZhdWx0LCBTdHJlYW1hYmxlLCBPbmVPck1vcmUsIEtleVJpbmcsXG4gIFZlcnNpb25lZERvYywgRG9jSWQsIERvY1JlZiwgRG9jUmV2cywgRG9jSWRSYW5nZSwgRG9jUmV2U3RhdHVzLCBSZWFkT3B0c1xufSBmcm9tICdjYm94LXZhdWx0J1xuaW1wb3J0IGdldEFjY291bnRGYWN0b3J5LCB7XG4gIEFjY291bnRGYWN0b3J5QnVpbGRlciwgQWNjb3VudEZhY3RvcnksIEFjY291bnQsIEFjY291bnRPYmplY3QsIEFjY291bnREb2Ncbn0gZnJvbSAnemVueXBhc3MtYWNjb3VudC1tb2RlbCdcbmltcG9ydCB7IE9ic2VydmFibGUgfSBmcm9tICdyeGpzJ1xuaW1wb3J0IHsgX19hc3NpZ24gYXMgYXNzaWduIH0gZnJvbSAndHNsaWInXG5cbmV4cG9ydCB7IEFjY291bnRGYWN0b3J5LCBBY2NvdW50LCBBY2NvdW50T2JqZWN0IH1cblxuZXhwb3J0IGludGVyZmFjZSBaZW55cGFzc1ZhdWx0U2VydmljZUZhY3Rvcnkge1xuICAodmF1bHQ6IENib3hWYXVsdCwgYXV0aG9yaXplOiAocGFzc3BocmFzZT86IHN0cmluZykgPT4gUHJvbWlzZTxib29sZWFuPixcbiAgb3B0cz86IFBhcnRpYWw8WmVueXBhc3NWYXVsdFNlcnZpY2VTcGVjPik6ICBaZW55cGFzc1ZhdWx0U2VydmljZVxufVxuXG5leHBvcnQgaW50ZXJmYWNlIFplbnlwYXNzVmF1bHRTZXJ2aWNlU3BlYyB7XG4gIGdldEFjY291bnRGYWN0b3J5OiBBY2NvdW50RmFjdG9yeUJ1aWxkZXJcbn1cblxuZXhwb3J0IGludGVyZmFjZSBaZW55cGFzc1ZhdWx0U2VydmljZSB7XG4gIG5ld0FjY291bnQ6IEFjY291bnRGYWN0b3J5XG4gIC8qKlxuICAgKiBAcHVibGljXG4gICAqIEBtZXRob2RcbiAgICpcbiAgICogQGRlc2NyaXB0aW9uXG4gICAqIHJ4IG9wZXJhdG9yIHRoYXQgc3RvcmVzIHRoZSBkb2N1bWVudHMgZnJvbSBhbiBpbnB1dCBzZXF1ZW5jZSB0b1xuICAgKiB0aGUgdW5kZXJseWluZyAoY2JveC12YXVsdClbaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvY2JveC12YXVsdF0gaW5zdGFuY2UsXG4gICAqIGFuZCBtYXBzIHRoYXQgaW5wdXQgc2VxdWVuY2UgdG8gYSBjb3JyZXNwb25kaW5nIHNlcXVlbmNlIG9mXG4gICAqIHJlc3VsdGluZyB7RG9jUmVmfSByZWZlcmVuY2VzLlxuICAgKlxuICAgKiBAcGFyYW0ge09ic2VydmFibGU8WmVueXBhc3NEb2NbXXxaZW55cGFzc0RvYz59IGRvYyRcbiAgICogYSBzZXF1ZW5jZSBvZiBpbnN0YW5jZXMgb3IgYXJyYXlzIG9mIHtaZW55cGFzc0RvY30gdmVyc2lvbmVkIGRvY3VtZW50cy5cbiAgICpcbiAgICogQHJldHVybiB7T2JzZXJ2YWJsZTxEb2NSZWZbXXxEb2NSZWY+fVxuICAgKiBzZXF1ZW5jZSBvZiByZXN1bHRpbmcge0RvY1JlZn0gcmVmZXJlbmNlcyBhZnRlciBzdG9yYWdlLlxuICAgKiB3aGVuIHRoZSBpbnB1dCBgZG9jJGAgc2VxdWVuY2UgZW1pdHMgYW4gYXJyYXkgb2YgZG9jdW1lbnRzLFxuICAgKiB0aGUgb3V0cHV0IHNlcXVlbmNlIGVtaXRzIGEgcmVzdWx0aW5nIGFycmF5IG9mIHtEb2NSZWZ9IHJlZmVyZW5jZXMsXG4gICAqIGluIHRoZSBzYW1lIG9yZGVyLlxuICAgKlxuICAgKiBAZXJyb3Ige0Vycm9yfSB3aGVuIHN0b3JpbmcgYSBkb2N1bWVudCBmYWlscyxcbiAgICogZS5nLiB3aGVuIHRoZSB1bmRlcmx5aW5nIGtleSBpcyBsb2NrZWQuXG4gICAqIC8vIFRPRE8gcHJvdmlkZSBtb3JlIGRldGFpbCBvbiBwb3NzaWJsZSBzdG9yYWdlIGVycm9yc1xuICAgKlxuICAgKiBAbWVtYmVyT2YgWmVueXBhc3NWYXVsdFNlcnZpY2VcbiAgICovXG4gIHdyaXRlIChhY2NvdW50czogU3RyZWFtYWJsZTxBY2NvdW50Pik6IE9ic2VydmFibGU8QWNjb3VudD5cbiAgd3JpdGUgKGFjY291bnRzOiBTdHJlYW1hYmxlPEFjY291bnRbXT4pOiBPYnNlcnZhYmxlPEFjY291bnRbXT5cbiAgd3JpdGUgKGFjY291bnRzOiBTdHJlYW1hYmxlPE9uZU9yTW9yZTxBY2NvdW50Pj4pOiBPYnNlcnZhYmxlPE9uZU9yTW9yZTxBY2NvdW50Pj5cblxuICAvKipcbiAgICogQHB1YmxpY1xuICAgKiBAbWV0aG9kXG4gICAqXG4gICAqIEBkZXNjcmlwdGlvblxuICAgKiByeCBvcGVyYXRvciB0aGF0IG1hcHMgYSBzZXF1ZW5jZSBvZiBkb2N1bWVudCByZWZlcmVuY2VzXG4gICAqIHRvIHRoZSBjb3JyZXNwb25kaW5nIGRvY3VtZW50cyBmZXRjaGVkIGZyb21cbiAgICogdGhlIHVuZGVybHlpbmcgKGNib3gtdmF1bHQpW2h0dHBzOi8vd3d3Lm5wbWpzLmNvbS9wYWNrYWdlL2Nib3gtdmF1bHRdIGluc3RhbmNlLlxuICAgKiB0aGUgaW5wdXQgZG9jdW1lbnQgcmVmZXJlbmNlIHNlcXVlbmNlIG1heSBhbHRlcm5hdGl2ZWx5IGVtaXRcbiAgICogYW55IG9mIHRoZSBmb2xsb3dpbmc6XG4gICAqICogaW5kaXZpZHVhbCB7RG9jUmVmfSBvciB7RG9jSWR9IHJlZmVyZW5jZXMsXG4gICAqICogYXJyYXlzIG9mIHtEb2NSZWZ9IG9yIHtEb2NJZH0gcmVmZXJlbmNlcyxcbiAgICogKiB7RG9jSWRSYW5nZX0gcmFuZ2VzIG9mIGRvY3VtZW50IHJlZmVyZW5jZXMsXG4gICAqICoge0RvY1JldnN9IHNldHMgb2YgcmVmZXJlbmNlcyB0byBkb2N1bWVudCByZXZpc2lvbnMuXG4gICAqXG4gICAqIEBwYXJhbSB7T2JzZXJ2YWJsZTxEb2NSZWZbXXxEb2NJZFJhbmdlfERvY1JldnN8RG9jUmVmPn0gcmVmJFxuICAgKiBhIHNlcXVlbmNlIG9mIGRvY3VtZW50IHJlZmVyZW5jZXMuXG4gICAqXG4gICAqIEByZXR1cm4ge09ic2VydmFibGU8WmVueXBhc3NEb2NbXXxaZW55cGFzc0RvY3woWmVueXBhc3NEb2MmRG9jUmV2U3RhdHVzKT59XG4gICAqIHRoZSByZWZlcmVuY2VkIHtaZW55cGFzc0RvY30gZG9jdW1lbnQocylcbiAgICogd2l0aCBhbGwgb2YgaXRzIGNvbnRlbnQgfn5leGNsdWRpbmcgdGhlIGByZXN0cmljdGVkYCBlbnRyeX5+LFxuICAgKiBvciBvbmx5IHRoZSBjb3JyZXNwb25kaW5nIHtaZW55cGFzc0RvY30gc3R1YmJlZCByZWZlcmVuY2VzLFxuICAgKiByZXRyaWV2ZWQgZnJvbSB0aGUgdW5kZXJseWluZ1xuICAgKiAoY2JveC12YXVsdClbaHR0cHM6Ly93d3cubnBtanMuY29tL3BhY2thZ2UvY2JveC12YXVsdF0gaW5zdGFuY2UuXG4gICAqIHdoZW4gdGhlIGlucHV0IGByZWZzYCBzZXF1ZW5jZSBlbWl0c1xuICAgKiBhbiBhcnJheSBvZiB7RG9jUmVmfSBvciB7RG9jSWR9IHJlZmVyZW5jZXMsXG4gICAqIGEge0RvY0lkUmFuZ2V9IHJhbmdlIG9mIGRvY3VtZW50IHJlZmVyZW5jZXMsXG4gICAqIG9yIGEge0RvY1JldnN9IHNldCBvZiByZWZlcmVuY2VzIHRvIGRvY3VtZW50IHJldmlzaW9ucyxcbiAgICogdGhlIG91dHB1dCBzZXF1ZW5jZSBlbWl0cyBhIHJlc3VsdGluZyBhcnJheVxuICAgKiBvZiB7WmVueXBhc3NEb2N9IGRvY3VtZW50cyBvciB7RG9jUmVmfSByZWZlcmVuY2VzLFxuICAgKiBpbiB0aGUgb3JkZXIgb2YgdGhlIGlucHV0IGFycmF5IG9mIHJlZmVyZW5jZXMsXG4gICAqIG9yIGVsc2UgYXMgc3BlY2lmaWVkIGJ5IHRoZSB7RG9jSWRSYW5nZX0gcmFuZ2UuXG4gICAqXG4gICAqIEBlcnJvciB7RXJyb3J9IHdoZW4gcmV0cmlldmluZyBhIGRvY3VtZW50IGZhaWxzXG4gICAqIGUuZy4gd2hlbiB0aGUgdW5kZXJseWluZyBrZXkgaXMgbG9ja2VkLlxuICAgKiAvLyBUT0RPIHByb3ZpZGUgbW9yZSBkZXRhaWwgb24gcG9zc2libGUgZmV0Y2ggZXJyb3JzXG4gICAqXG4gICAqIEBtZW1iZXJPZiBaZW55cGFzc1ZhdWx0U2VydmljZVxuICAgKi9cbiAgcmVhZCAocmVmczogU3RyZWFtYWJsZTxEb2NSZWY+LCBvcHRzPzogUmVhZE9wdHMpOiBPYnNlcnZhYmxlPEFjY291bnQ+XG4gIHJlYWQgKHJlZnM6IFN0cmVhbWFibGU8RG9jUmVmW10+LCBvcHRzPzogUmVhZE9wdHMpOiBPYnNlcnZhYmxlPEFjY291bnRbXT5cbiAgcmVhZCAocmVmczogU3RyZWFtYWJsZTxEb2NJZFJhbmdlPiwgb3B0cz86IFJlYWRPcHRzKTogT2JzZXJ2YWJsZTxBY2NvdW50W10+XG4gIHJlYWQgKHJlZnM6IFN0cmVhbWFibGU8T25lT3JNb3JlPERvY1JlZj58RG9jSWRSYW5nZT4sIG9wdHM/OiBSZWFkT3B0cyk6XG4gIE9ic2VydmFibGU8T25lT3JNb3JlPEFjY291bnQ+PlxuICB1bmxvY2soa2V5czogS2V5UmluZyk6IFplbnlwYXNzVmF1bHRTZXJ2aWNlXG59XG5cbmNvbnN0IFZBVUxUX1NFUlZJQ0VfU1BFQ19ERUZBVUxUUyA9IHtcbiAgZ2V0QWNjb3VudEZhY3Rvcnk6IGdldEFjY291bnRGYWN0b3J5XG59XG5cblxuY2xhc3MgX1ZhdWx0U2VydmljZSB7XG4gIHN0YXRpYyBnZXRJbnN0YW5jZTogWmVueXBhc3NWYXVsdFNlcnZpY2VGYWN0b3J5ID1cbiAgZnVuY3Rpb24gKHZhdWx0OiBDYm94VmF1bHQsIGF1dGhvcml6ZTogKHBhc3NwaHJhc2U/OiBzdHJpbmcpID0+IFByb21pc2U8Ym9vbGVhbj4sXG4gIG9wdHM/OiBQYXJ0aWFsPFplbnlwYXNzVmF1bHRTZXJ2aWNlU3BlYz4pOiBaZW55cGFzc1ZhdWx0U2VydmljZSB7XG4gICAgY29uc3Qgc3BlYzogWmVueXBhc3NWYXVsdFNlcnZpY2VTcGVjID0gYXNzaWduKHt9LCBWQVVMVF9TRVJWSUNFX1NQRUNfREVGQVVMVFMsIG9wdHMpXG4gICAgY29uc3QgZ2V0Q3VzdG9tQWNjb3VudEZhY3RvcnkgPSBzcGVjLmdldEFjY291bnRGYWN0b3J5LmJpbmQodm9pZCAwLCBhdXRob3JpemUpXG4gICAgY29uc3Qgb3BlcmF0b3JzID0gZ2V0QWNjb3VudFN0cmVhbU9wZXJhdG9ycyhnZXRDdXN0b21BY2NvdW50RmFjdG9yeSlcblxuICAgIGNvbnN0IGFjY291bnRWYXVsdCA9IG5ldyBfVmF1bHRTZXJ2aWNlKHZhdWx0LCBvcGVyYXRvcnMubmV3QWNjb3VudCwgb3BlcmF0b3JzKVxuICAgIHJldHVybiB7XG4gICAgICBuZXdBY2NvdW50OiBhY2NvdW50VmF1bHQubmV3QWNjb3VudC5iaW5kKGFjY291bnRWYXVsdCksXG4gICAgICB3cml0ZTogYWNjb3VudFZhdWx0LndyaXRlLmJpbmQoYWNjb3VudFZhdWx0KSxcbiAgICAgIHJlYWQ6IGFjY291bnRWYXVsdC5yZWFkLmJpbmQoYWNjb3VudFZhdWx0KSxcbiAgICAgIHVubG9jayAoa2V5czogS2V5UmluZykge1xuICAgICAgICByZXR1cm4gX1ZhdWx0U2VydmljZS5nZXRJbnN0YW5jZSh2YXVsdC51bmxvY2soa2V5cyksIGF1dGhvcml6ZSwgb3B0cylcbiAgICAgIH1cbiAgICB9XG4gIH1cblxuICB3cml0ZSAoYWNjb3VudHM6IFN0cmVhbWFibGU8T25lT3JNb3JlPEFjY291bnQ+Pikge1xuICAgIGNvbnN0IGRvYyQ6IE9ic2VydmFibGU8T25lT3JNb3JlPEFjY291bnREb2M+PiA9XG4gICAgdGhpcy5vcGVyYXRvcnMuZnJvbUFjY291bnQoT2JzZXJ2YWJsZS5mcm9tKGFjY291bnRzKSlcblxuICAgIGNvbnN0IGFjY291bnQkOiBPYnNlcnZhYmxlPE9uZU9yTW9yZTxBY2NvdW50Pj4gPVxuICAgIHRoaXMub3BlcmF0b3JzLnRvQWNjb3VudCh0aGlzLnZhdWx0LndyaXRlKGRvYyQpKVxuXG4gICAgcmV0dXJuIGFjY291bnQkXG4gIH1cblxuICByZWFkIChyZWZzOiBTdHJlYW1hYmxlPE9uZU9yTW9yZTxEb2NSZWY+fERvY0lkUmFuZ2U+LCBvcHRzPzogUmVhZE9wdHMpIHtcbiAgICBjb25zdCBkb2MkID0gdGhpcy52YXVsdC5yZWFkPEFjY291bnREb2M+KHJlZnMpXG4gICAgY29uc3QgYWNjb3VudCQ6IE9ic2VydmFibGU8T25lT3JNb3JlPEFjY291bnQ+PiA9IHRoaXMub3BlcmF0b3JzLnRvQWNjb3VudChkb2MkKVxuICAgIHJldHVybiBhY2NvdW50JFxuICB9XG5cbiAgcHJpdmF0ZSBjb25zdHJ1Y3RvciAoXG4gICAgcmVhZG9ubHkgdmF1bHQ6IENib3hWYXVsdCxcbiAgICByZWFkb25seSBuZXdBY2NvdW50OiBBY2NvdW50RmFjdG9yeSxcbiAgICBwcml2YXRlIHJlYWRvbmx5IG9wZXJhdG9yczogQWNjb3VudFN0cmVhbU9wZXJhdG9yc1xuICApIHt9XG59XG5cbmNvbnN0IGdldFZhdWx0U2VydmljZTogWmVueXBhc3NWYXVsdFNlcnZpY2VGYWN0b3J5ID0gX1ZhdWx0U2VydmljZS5nZXRJbnN0YW5jZVxuZXhwb3J0IGRlZmF1bHQgZ2V0VmF1bHRTZXJ2aWNlXG4iXX0=
